import{r as u,j as e,L as b,u as N}from"./app-CgQ5_Exw.js";import{C as f}from"./chevron-down-DPMERgs6.js";import{S as w}from"./search-CDbg9dwJ.js";import{M as k}from"./map-pin-CoMb9nXS.js";import{C as v}from"./clock-Cjlu6ONk.js";import{U as C}from"./users-D_KveccA.js";import{L as _}from"./landing-layout-CwVnJRfA.js";import"./app-BKSfwL7n.js";import"./utils-B4smH_VX.js";import"./navbar-BNbmtS1e.js";import"./avatar-CqAQLXEM.js";import"./index-Bg-JEsM4.js";import"./proxy-Cq8dZP5I.js";import"./user-D5RYSoco.js";const L=({filters:a,searchQuery:r,setSearchQuery:m,selectedJenis:s,setSelectedJenis:c,selectedFasilitas:i,setSelectedFasilitas:n})=>{const[l,o]=u.useState(["nama-klinik","jenis-klinik","fasilitas"]),x=t=>{o(d=>d.includes(t)?d.filter(h=>h!==t):[...d,t])},g=()=>{m(""),c([]),n([])};return e.jsxs("aside",{className:"h-fit w-full max-w-xs self-start rounded-xl border border-gray-200 bg-white p-4 shadow-sm",children:[e.jsx("h3",{className:"mb-4 text-xl font-semibold text-gray-900",children:"Filter Klinik"}),e.jsxs("div",{className:"mb-5",children:[e.jsxs("button",{onClick:()=>x("nama-klinik"),className:"mb-2 flex w-full items-center justify-between text-sm font-medium text-gray-800",children:["Nama Klinik",e.jsx(f,{className:`h-4 w-4 text-gray-400 transition-transform ${l.includes("nama-klinik")?"rotate-180":""}`})]}),l.includes("nama-klinik")&&e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"Cari nama klinik",value:r,onChange:t=>m(t.target.value),className:"w-full rounded-lg border border-gray-300 px-3 py-2 pr-9 text-sm focus:border-emerald-500 focus:ring-2 focus:ring-emerald-100 focus:outline-none"}),e.jsx(w,{className:"absolute top-2.5 right-3 h-4 w-4 text-gray-400"})]})]}),e.jsxs("div",{className:"mb-5",children:[e.jsxs("button",{onClick:()=>x("jenis-klinik"),className:"mb-2 flex w-full items-center justify-between text-sm font-medium text-gray-800",children:["Jenis Klinik",e.jsx(f,{className:`h-4 w-4 text-gray-400 transition-transform ${l.includes("jenis-klinik")?"rotate-180":""}`})]}),l.includes("jenis-klinik")&&e.jsx("div",{className:"space-y-2 text-sm text-gray-700",children:a.jenis_klinik.map(t=>e.jsxs("label",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:s.includes(t.jenis_klinik),onChange:d=>{d.target.checked?c([...s,t.jenis_klinik]):c(s.filter(h=>h!==t.jenis_klinik))},className:"accent-emerald-600"}),t.jenis_klinik]}),e.jsx("span",{className:"text-xs text-gray-400",children:t.count})]},t.jenis_klinik))})]}),e.jsxs("div",{className:"mb-5",children:[e.jsxs("button",{onClick:()=>x("fasilitas"),className:"mb-2 flex w-full items-center justify-between text-sm font-medium text-gray-800",children:["Fasilitas",e.jsx(f,{className:`h-4 w-4 text-gray-400 transition-transform ${l.includes("fasilitas")?"rotate-180":""}`})]}),l.includes("fasilitas")&&e.jsx("div",{className:"space-y-2 text-sm text-gray-700",children:a.fasilitas.map(t=>e.jsxs("label",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:i.includes(t.id),onChange:d=>{d.target.checked?n([...i,t.id]):n(i.filter(h=>h!==t.id))},className:"accent-emerald-600"}),t.nama]}),e.jsx("span",{className:"text-xs text-gray-400",children:t.klinik_count})]},t.id))})]}),e.jsx("button",{onClick:g,className:"mt-4 w-full rounded-lg border border-gray-300 bg-gray-50 px-3 py-2 text-sm font-medium text-gray-700 hover:bg-gray-100",children:"Clear Filter"})]})};function M(a,r){const s=x=>x*Math.PI/180,c=s(r.lat-a.lat),i=s(r.lng-a.lng),n=s(a.lat),l=s(r.lat),o=Math.sin(c/2)*Math.sin(c/2)+Math.sin(i/2)*Math.sin(i/2)*Math.cos(n)*Math.cos(l);return 6371*2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o))}const S=a=>a.toLowerCase().trim().replace(/\s+/g,"-").replace(/[^\w\-]+/g,""),K=({kliniks:a})=>{const[r,m]=u.useState(a);return u.useEffect(()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(s=>{const c={lat:s.coords.latitude,lng:s.coords.longitude};m(a.map(i=>({...i,jarak:M(c,{lat:i.latitude,lng:i.longitude})})))},()=>{},{enableHighAccuracy:!0,timeout:8e3})},[a]),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:["Menampilkan ",a.length," klinik"]}),e.jsxs("select",{className:"rounded-lg border border-gray-300 bg-white px-3 py-1.5 text-sm focus:ring-2 focus:ring-emerald-500 focus:outline-none",children:[e.jsx("option",{children:"Urutkan: Popularitas"}),e.jsx("option",{children:"Rating Tertinggi"}),e.jsx("option",{children:"Kapasitas Terbanyak"})]})]}),r.map(s=>{const c=`/klinik/${S(s.nama_klinik)}-${s.id}`;return e.jsxs("div",{className:"group relative flex overflow-hidden rounded-xl border bg-white shadow-sm transition hover:shadow-md",children:[e.jsx("div",{className:"relative h-48 w-60 shrink-0",children:e.jsx("img",{src:s.gambar??"/placeholder-image.jpg",alt:s.nama_klinik,className:"h-full w-full object-cover"})}),e.jsxs("div",{className:"flex flex-1 flex-col justify-between p-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"line-clamp-1 text-xl font-semibold text-gray-900",children:s.nama_klinik}),e.jsx("span",{className:"rounded-full bg-emerald-600 px-3 py-1 text-xs font-semibold text-white shadow",children:s.jenis_klinik})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"mt-1 flex items-center gap-1 text-sm text-gray-500",children:[e.jsx(k,{className:"h-3.5 w-3.5"}),s.alamat,", ",s.kota,s.jarak!==void 0&&e.jsxs("span",{className:"ml-1 text-emerald-600",children:["• ±",s.jarak.toFixed(1)," km"]})]}),(()=>{const i=["Senin","Selasa","Rabu","Kamis","Jumat","Sabtu","Minggu"],n=s.jam_operasional?.filter(l=>l.tutup===0).map(l=>l.hari).sort((l,o)=>i.indexOf(l)-i.indexOf(o));return!n||n.length===0?null:e.jsxs("div",{className:"mt-1 flex items-center gap-1 text-xs text-gray-500",children:[e.jsx(v,{className:"h-3.5 w-3.5"}),n[0],n[0]!==n[n.length-1]&&` - ${n[n.length-1]}`]})})(),e.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-500",children:[e.jsx(C,{className:"h-4 w-4"}),s.kapasitas_tersedia,"/",s.kapasitas_total," tempat tidur"]})]})]}),e.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[s.fasilitas?.length>0&&e.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[s.fasilitas.slice(0,3).map(i=>e.jsx("span",{className:"rounded-full bg-gray-100 px-3 py-0.5 text-xs font-medium text-gray-700",children:i.nama},i.id)),s.fasilitas.length>3&&e.jsxs("span",{className:"text-xs text-gray-500",children:["+",s.fasilitas.length-3," ","lainnya"]})]}),e.jsx(b,{href:c,className:"rounded-lg bg-emerald-600 px-4 py-2 text-sm font-semibold text-white transition hover:bg-emerald-700",children:"Lihat Detail"})]})]})]},s.id)})]})},P=a=>{const r=new URLSearchParams(a.split("?")[1]??"");return{q:r.get("q")??"",jenis:r.getAll("jenis")}},R=({kliniks:a,filters:r,url:m})=>{const s=P(m),[c,i]=u.useState(s.q),[n,l]=u.useState(s.jenis),[o,x]=u.useState([]),g=a.filter(t=>{const d=t.nama_klinik.toLowerCase().includes(c.toLowerCase())||t.kota.toLowerCase().includes(c.toLowerCase()),h=n.length>0?n.includes(t.jenis_klinik):!0,j=o.length>0?o.every(p=>t.fasilitas.some(y=>y.id===p)):!0;return d&&h&&j});return e.jsx("section",{className:"mx-auto w-full max-w-7xl px-6 py-10",children:e.jsxs("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-[280px_1fr]",children:[e.jsx(L,{filters:r,searchQuery:c,setSearchQuery:i,selectedJenis:n,setSelectedJenis:l,selectedFasilitas:o,setSelectedFasilitas:x}),e.jsx(K,{kliniks:g})]})})};function W({kliniks:a,filters:r}){const{url:m}=N();return e.jsx(_,{children:e.jsx(R,{kliniks:a,filters:r,url:m})})}export{W as default};
